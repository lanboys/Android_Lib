<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>HTTP权威指南 (图灵程序设计丛书)</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos928213" class="calibre_"><span class="calibre3"><span class="bold">14.6　数字证书</span></span></p><p class="calibre_">本节将介绍因特网上的“ID 卡”——数字证书。数字证书（通常被称作“certs”，有点像 certs 牌薄荷糖）中包含了由某个受信任组织担保的用户或公司的相关信息。</p><p class="calibre_">我们每个人都有很多形式的身份证明。有些 ID，比如护照和驾照，都足以在很多场合证明某人的身份。例如，你可以用美国的驾照在新年前夜搭乘前往纽约的航班，在你到那儿之后，接着用它来证明你的年龄，这样你就能和朋友们一起喝酒了。</p><p class="calibre_">受信程度更高的身份证明，比如护照，是由政府在特殊的纸上签发并盖章的。很难伪造，因此可以承载较高的信任度。有些公司的徽章和智能卡中包含有电子信息，以强化使用者的身份证明。有些绝密的政府组织甚至会对你的指纹或视网膜毛细血管模式进行匹配以便确认你的 ID ！</p><p class="calibre_">有些形式的 ID，比如名片，相对来说更容易伪造，因此人们不太信任这些信息。虽然足以应付职场交流，但申请住房贷款时，可能就不足以证明你的就业情况了。</p><p class="calibre_"><span class="calibre3"><span class="bold">14.6.1　证书的主要内容</span></span></p><p class="calibre_">数字证书中还包含一组信息，所有这些信息都是由一个官方的“证书颁发机构”以数字方式签发的。基本的数字证书中通常包含一些纸质 ID 中常见的内容，比如：</p><div class="calibre_5"> </div><ul class="calibre_6"><li value="1" class="calibre_7"><p class="calibre_">对象的名称（人、服务器、组织等）；</p></li><li value="2" class="calibre_7"><p class="calibre_">过期时间；</p></li><li value="3" class="calibre_7"><p class="calibre_">证书发布者（由谁为证书担保）；</p></li><li value="4" class="calibre_7"><p class="calibre_">来自证书发布者的数字签名。</p></li></ul><p class="calibre_">而且，数字证书通常还包括对象的公开密钥，以及对象和所用签名算法的描述性信息。任何人都可以创建一个数字证书，但并不是所有人都能够获得受人尊敬的签发权，从而为证书信息担保，并用其私有密钥签发证书。典型的证书结构如图 14-11 所示。</p><p class="calibre_8"><img src="images/00024.jpg" class="calibre_102"/></p><p class="calibre_10"><span class="calibre7">图 14-11　典型的数字签名格式</span></p><p class="calibre_"><span class="calibre3"><span class="bold">14.6.2　X.509 v3证书</span></span></p><p class="calibre_">不幸的是，数字证书没有单一的全球标准。就像不是所有印刷版 ID 卡都在同样的位置包含了同样的信息一样，数字证书也有很多略有不同的形式。 不过好消息就是现在使用的大多数证书都以一种标准格式——X.509 v3，来存储它们的信息。X.509 v3 证书提供了一种标准的方式，将证书信息规范至一些可解析字段中。不同类型的证书有不同的字段值，但大部分都遵循 X.509 v3 结构。表 14-2 介绍了 X.509 证书中的字段信息。</p><p class="calibre_"><span class="bold">表14-2　X.509证书字段</span></p><p class="calibre2" style="margin:0pt; border:0pt; height:1em"> </p><table valign="top" class="calibre_14"><tr valign="top" class="calibre9"><th valign="top" class="calibre_70"><span class="calibre7"><span class="bold"> 字　　段 </span></span>
</th><th valign="top" class="calibre_44"><span class="calibre7"><span class="bold"> 描　　述 </span></span>
</th></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> 版本 </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 这个证书的 X.509 证书版本号。现在使用的通常都是版本3 </span><span class="calibre_18">
</span></td></tr><tr valign="top" class="calibre9"><td valign="top" class="calibre10"><span class="calibre7"> 序列号 </span>
</td><td valign="top" class="calibre10"><span class="calibre7"> 证书颁发机构（CA）生成的唯一整数。CA 生成的每个证书都要有一个唯一的序列号 </span>
</td></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> 签名算法 ID </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 签名所使用的加密算法。例如，“用 RSA 加密的 MD2 摘要” </span><span class="calibre_18">
</span></td></tr><tr valign="top" class="calibre9"><td valign="top" class="calibre10"><span class="calibre7"> 证书颁发者 </span>
</td><td valign="top" class="calibre10"><span class="calibre7"> 发布并签署这个证书的组织名称，以 X.500 格式表示 </span>
</td></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> 有效期 </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 此证书何时有效，由一个起始日期和一个结束日期来表示 </span><span class="calibre_18">
</span></td></tr><tr valign="top" class="calibre9"><td valign="top" class="calibre10"><span class="calibre7"> 对象名称 </span>
</td><td valign="top" class="calibre10"><span class="calibre7"> 证书中描述的实体，比如一个人或一个组织。对象名称是以 X.500 格式表示的 </span>
</td></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> 对象的公开密钥信息 </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 证书对象的公开密钥，公开密钥使用的算法，以及所有附加参数 </span><span class="calibre_18">
</span></td></tr><tr valign="top" class="calibre9"><td valign="top" class="calibre10"><span class="calibre7"> 发布者唯一的ID（可选） </span>
</td><td valign="top" class="calibre10"><span class="calibre7"> 可选的证书发布者唯一标识符，这样就可以重用相同的发布者名称 </span>
</td></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> 对象唯一的ID（可选） </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 可选的证书对象唯一标识符，这样就可以重用相同的对象名称了 </span><span class="calibre_18">
</span></td></tr><tr valign="top" class="calibre9"><td valign="top" class="calibre10"><span class="calibre7"> 扩展 </span>
</td><td valign="top" class="calibre10"><span class="calibre7"> 可选的扩展字段集（在版本 3 及更高的版本中使用）。每个扩展字段都被标识为关键或非关键的。关键扩展非常重要，证书使用者一定要能够理解。如果证书使用者无法识别出关键扩展字段，就必须拒绝这个证书。</span><br class="calibre2"/><span class="calibre7">目前在使用的常用扩展字段包括：</span><br class="calibre2"/><span class="calibre7"><span class="bold">基本约束</span></span><br class="calibre2"/><span class="calibre7">对象与证书颁发机构的关系</span><br class="calibre2"/><span class="calibre7"><span class="bold">证书策略</span></span><br class="calibre2"/><span class="calibre7">授予证书的策略</span><br class="calibre2"/><span class="calibre7"><span class="bold">密钥的使用</span></span><br class="calibre2"/><span class="calibre7"> </span><span class="calibre7">对公开密钥使用的限制</span>
</td></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> 证书的颁发机构签名 </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 证书颁发机构用指定的签名算法对上述所有字段进行的数字签名 </span><span class="calibre_18">
</span></td></tr></table><p class="calibre_">基于 X.509 证书的签名有好几种，（其中）包括 Web 服务器证书、客户端电子邮件证书、软件代码签名证书和证书颁发机构证书。</p><p class="calibre_"><span class="calibre3"><span class="bold">14.6.3　用证书对服务器进行认证</span></span></p><p class="calibre_">通过 HTTPS 建立了一个安全 Web 事务之后，现代的浏览器都会自动获取所连接服务器的数字证书。如果服务器没有证书，安全连接就会失败。服务器证书中包含很多字段，其中包括：</p><div class="calibre_5"> </div><ul class="calibre_6"><li value="1" class="calibre_7"><p class="calibre_">Web 站点的名称和主机名；</p></li><li value="2" class="calibre_7"><p class="calibre_">Web 站点的公开密钥；</p></li><li value="3" class="calibre_7"><p class="calibre_">签名颁发机构的名称；</p></li><li value="4" class="calibre_7"><p class="calibre_">来自签名颁发机构的签名。</p></li></ul><p class="calibre_">浏览器收到证书时会对签名颁发机构进行检查。<sup class="calibre4"><small class="calibre5"><span class="calibre6">1</span></small></sup> 如果这个机构是个很有权威的公共签名机构，浏览器可能已经知道其公开密钥了（浏览器会预先安装很多签名颁发机构的证书）。这样，就可以像前面的 14.5 节中所讨论的那样验证签名了。图 14-12 说明了如何通过其数字签名来验证证书的完整性。</p><p class="calibre_"><sup class="calibre4"><small class="calibre5"><span class="calibre6">1 浏览器和其他因特网应用程序都会尽量隐藏大部分证书管理的细节，使得浏览更加方便。但通过安全连接进行浏览时，所有主要的浏览器都允许你自己去检查所要对话站点的证书，以确保所有内容都是诚实可信的。</span></small></sup></p><p class="calibre_">如果对签名颁发机构一无所知，浏览器就无法确定是否应该信任这个签名颁发机构，它通常会向用户显示一个对话框，看看他是否相信这个签名发布者。签名发布者可能是本地的 IT 部门或软件厂商。</p><p class="calibre_8"><img src="images/00098.jpg" class="calibre_175"/></p><p class="calibre_10"><span class="calibre7">图 14-12　验证签名是真的</span></p><div class="mbp_pagebreak" id="calibre_pb_138"></div>
</body></html>
