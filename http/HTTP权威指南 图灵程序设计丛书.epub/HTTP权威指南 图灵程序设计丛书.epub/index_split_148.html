<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>HTTP权威指南 (图灵程序设计丛书)</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
<p id="filepos998196" class="calibre_"><span class="calibre3"><span class="bold">15.4　媒体类型和字符集</span></span></p><p class="calibre_"><tt class="calibre8">Content-Type</tt> 首部字段说明了实体主体的 MIME 类型。<sup class="calibre4"><small class="calibre5"><span class="calibre6">1</span></small></sup> MIME 类型是标准化的名字，用以说明作为货物运载实体的基本媒体类型（比如：HTML 文件、Microsoft Word 文档或是 MPEG 视频等）。客户端应用程序使用 MIME 类型来解释和处理其内容。</p><p class="calibre_"><sup class="calibre4"><small class="calibre5"><span class="calibre6">1 在 HEAD 请求中，</span><span class="calibre6"><tt class="calibre8">Content-Type</tt></span><span class="calibre6"> 说明如果请求是 GET 时，将要发送的主体的类型。</span></small></sup></p><p class="calibre_"><tt class="calibre8">Content-Type</tt> 的值是标准化的 MIME 类型，都在互联网号码分配机构（Internet Assigned Numbers Authority，简称 IANA）中注册。MIME 类型由一个主媒体类型（比如：text、image 或 audio 等 ）后面跟一条斜线以及一个子类型组成，子类型用于进一步描述媒体类型。表 15-1 中列出了一些 <tt class="calibre8">Content-Type</tt> 首部中常用的 MIME 类型。附录 D 中列出了更多的 MIME 类型。</p><p class="calibre_"><span class="bold">表15-1　常用媒体类型</span></p><p class="calibre2" style="margin:0pt; border:0pt; height:1em"> </p><table valign="top" class="calibre_14"><tr valign="top" class="calibre9"><th valign="top" class="calibre_70"><span class="calibre7"><span class="bold"> 媒体类型 </span></span>
</th><th valign="top" class="calibre_44"><span class="calibre7"><span class="bold"> 描　　述 </span></span>
</th></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> text/html </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 实体主体是 HTML 文档 </span><span class="calibre_18">
</span></td></tr><tr valign="top" class="calibre9"><td valign="top" class="calibre10"><span class="calibre7"> text/plain </span>
</td><td valign="top" class="calibre10"><span class="calibre7"> 实体主体是纯文本文档 </span>
</td></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> image/gif </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 实体主体是 GIF 格式的图像 </span><span class="calibre_18">
</span></td></tr><tr valign="top" class="calibre9"><td valign="top" class="calibre10"><span class="calibre7"> image/jpeg </span>
</td><td valign="top" class="calibre10"><span class="calibre7"> 实体主体是 JPEG 格式的图像 </span>
</td></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> audio/x-wav </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 实体主体包含 WAV 格式声音数据 </span><span class="calibre_18">
</span></td></tr><tr valign="top" class="calibre9"><td valign="top" class="calibre10"><span class="calibre7"> model/vrml </span>
</td><td valign="top" class="calibre10"><span class="calibre7"> 实体主体是三维的 VRML 模型 </span>
</td></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> application/vnd.ms-powerpoint </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 实体主体是 Microsoft PowerPoint 演示文档 </span><span class="calibre_18">
</span></td></tr><tr valign="top" class="calibre9"><td valign="top" class="calibre10"><span class="calibre7"> multipart/byteranges </span>
</td><td valign="top" class="calibre10"><span class="calibre7"> 实体主体有若干部分，每个部分都包含了完整文档中不同的字节范围 </span>
</td></tr><tr valign="top" class="calibre_17"><td valign="top" class="calibre10"><span class="calibre7"> message/http </span><span class="calibre_18">
</span></td><td valign="top" class="calibre10"><span class="calibre7"> 实体主体包含完整的 HTTP 报文（参见 TRACE） </span><span class="calibre_18">
</span></td></tr></table><p class="calibre_">要着重注意的是，<tt class="calibre8">Content-Type</tt> 首部说明的是原始实体主体的媒体类型。例如，如果实体经过内容编码的话，<tt class="calibre8">Content-Type</tt> 首部说明的仍是编码之前的实体主体的类型。</p><p class="calibre_"><span class="calibre3"><span class="bold">15.4.1　文本的字符编码</span></span></p><p class="calibre_"><tt class="calibre8">Content-Type</tt> 首部还支持可选的参数来进一步说明内容的类型。<tt class="calibre8">charset</tt>（字符集）参数就是个例子，它说明把实体中的比特转换为文本文件中的字符的方法：</p><blockquote class="calibre_21"><span class="calibre7"><tt class="calibre8">Content-Type: text/html; charset=iso-8859-4<br class="calibre2"/></tt></span></blockquote><p class="calibre_22">我们将在第 16 章详细讨论字符集。</p><p class="calibre_"><span class="calibre3"><span class="bold">15.4.2　多部分媒体类型</span></span></p><p class="calibre_">MIME 中的 <tt class="calibre8">multipart</tt>（多部分）电子邮件报文中包含多个报文，它们合在一起作为单一的复杂报文发送。每一部分都是独立的，有各自的描述其内容的集；不同的部分之间用分界字符串连接在一起。</p><p class="calibre_">HTTP 也支持多部分主体。不过，通常只用在下列两种情形之一：提交填写好的表格，或是作为承载若干文档片段的范围响应。</p><p class="calibre_"><span class="calibre3"><span class="bold">15.4.3　多部分表格提交</span></span></p><p class="calibre_">当提交填写的 HTTP 表格时，变长的文本字段和上传的对象都作为多部分主体里面独立的部分发送，这样表格中就可以填写各种不同类型和长度的值。比如，你可能选择用昵称和小照片来填写询问你的名字和介绍信息的表格，而你的朋友可能填了她的全名并在介绍信息表内抱怨了一堆大众汽车的修理问题。</p><p class="calibre_">HTTP 使用 <tt class="calibre8">Content-Type:multipart/form-data</tt> 或 <tt class="calibre8">Content-Type:multipart/mixed</tt> 这样的首部以及多部分主体来发送这种请求，举例如下：</p><blockquote class="calibre_21"><span class="calibre7"><tt class="calibre8">Content-Type: multipart/form-data; boundary=[abcdefghijklmnopqrstuvwxyz]<br class="calibre2"/></tt></span></blockquote><p class="calibre_22">其中的 <tt class="calibre8">boundary</tt> 参数说明了分割主体中不同部分所用的字符串。</p><p class="calibre_">下面的例子展示了 <tt class="calibre8">multipart/form-data</tt> 编码。假设我们有这样的表格：</p><blockquote class="calibre_21"><span class="calibre7"><tt class="calibre8">&lt;FORM action=”http://server.com/cgi/handle”<br class="calibre2"/>      enctype="multipart/form-data"<br class="calibre2"/>      method="post"&gt;<br class="calibre2"/>&lt;P&gt;<br class="calibre2"/>What is your name? &lt;INPUT type="text" name="submit-name"&gt;&lt;BR&gt;<br class="calibre2"/>What files are you sending? &lt;INPUT type="file" name="files"&gt;&lt;BR&gt;<br class="calibre2"/>&lt;INPUT type="submit" value="Send"&gt; &lt;INPUT type="reset"&gt;<br class="calibre2"/>&lt;/FORM&gt;<br class="calibre2"/></tt></span></blockquote><p class="calibre_22">如果用户在文本输入字段中键入 Sally，并选择了文本文件 essayfile.txt，用户 Agent 代理可能会发回下面这样的数据：</p><blockquote class="calibre_21"><span class="calibre7"><tt class="calibre8">Content-Type: multipart/form-data; boundary=AaB03x<br class="calibre2"/>--AaB03x<br class="calibre2"/>Content-Disposition: form-data; name="submit-name"<br class="calibre2"/>Sally<br class="calibre2"/>--AaB03x<br class="calibre2"/>Content-Disposition: form-data; name="files"; filename="essayfile.txt"<br class="calibre2"/>Content-Type: text/plain<br class="calibre2"/>...contents of essayfile.txt...<br class="calibre2"/>--AaB03x--<br class="calibre2"/></tt></span></blockquote><p class="calibre_22">如果用户还选了另一个（图像）文件 image?le.gif，用户 Agent 代理可能像下面这样构造这个部分：</p><blockquote class="calibre_21"><span class="calibre7"><tt class="calibre8">Content-Type: multipart/form-data; boundary=AaB03x<br class="calibre2"/>--AaB03x<br class="calibre2"/>Content-Disposition: form-data; name="submit-name"<br class="calibre2"/>Sally<br class="calibre2"/>--AaB03x<br class="calibre2"/>Content-Disposition: form-data; name="files"<br class="calibre2"/>Content-Type: multipart/mixed; boundary=BbC04y<br class="calibre2"/>--BbC04y<br class="calibre2"/>Content-Disposition: file; filename="essayfile.txt"<br class="calibre2"/>Content-Type: text/plain<br class="calibre2"/>...contents of essayfile.txt...<br class="calibre2"/>--BbC04y<br class="calibre2"/>Content-Disposition: file; filename="imagefile.gif"<br class="calibre2"/>Content-Type: image/gif<br class="calibre2"/>Content-Transfer-Encoding: binary<br class="calibre2"/>...contents of imagefile.gif...<br class="calibre2"/>--BbC04y--<br class="calibre2"/>--AaB03x--<br class="calibre2"/></tt></span></blockquote><p class="calibre_22"><span class="calibre3"><span class="bold">15.4.4　多部分范围响应</span></span></p><p class="calibre_">HTTP 对范围请求的响应也可以是多部分的。这样的响应中有 <tt class="calibre8">Content-Type: multipart/byteranges</tt> 首部和带有不同范围的多部分主体。下面是一个例子，展示了对文档不同范围的请求产生的响应：</p><blockquote class="calibre_21"><span class="calibre7"><tt class="calibre8">HTTP/1.0 206 Partial content<br class="calibre2"/>Server: Microsoft-IIS/5.0<br class="calibre2"/>Date: Sun, 10 Dec 2000 19:11:20 GMT<br class="calibre2"/>Content-Location: http://www.joes-hardware.com/gettysburg.txt<br class="calibre2"/>Content-Type: multipart/x-byteranges; boundary=--[abcdefghijklmnopqrstu<br class="calibre2"/>vwxyz]--<br class="calibre2"/>Last-Modified: Sat, 09 Dec 2000 00:38:47 GMT<br class="calibre2"/><br class="calibre2"/>--[abcdefghijklmnopqrstuvwxyz]--<br class="calibre2"/>Content-Type: text/plain<br class="calibre2"/>Content-Range: bytes 0-174/1441<br class="calibre2"/>Fourscore and seven years ago our fathers brought forth on this<br class="calibre2"/>continent a new nation, conceived in liberty and dedicated to the<br class="calibre2"/>proposition that all men are created equal.<br class="calibre2"/>--[abcdefghijklmnopqrstuvwxyz]--<br class="calibre2"/>Content-Type: text/plain<br class="calibre2"/>Content-Range: bytes 552-761/1441<br class="calibre2"/><br class="calibre2"/>But in a larger sense, we can not dedicate, we can not consecrate,<br class="calibre2"/>we can not hallow this ground. The brave men, living and dead who<br class="calibre2"/>struggled here have consecrated it far above our poor power to add<br class="calibre2"/>or detract.<br class="calibre2"/>--[abcdefghijklmnopqrstuvwxyz]--<br class="calibre2"/>Content-Type: text/plain<br class="calibre2"/>Content-Range: bytes 1344-1441/1441<br class="calibre2"/><br class="calibre2"/>and that government of the people, by the people, for the people shall<br class="calibre2"/>not perish from the earth.<br class="calibre2"/><br class="calibre2"/>--[abcdefghijklmnopqrstuvwxyz]--<br class="calibre2"/></tt></span></blockquote><p class="calibre_22">本章后面将详细讨论范围请求。</p><div class="mbp_pagebreak" id="calibre_pb_148"></div>
</body></html>
